<Window x:Class="IrisSort.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="IrisSort - AI Image Renaming" 
        Height="700" Width="1100"
        MinHeight="600" MinWidth="900"
        Background="{StaticResource BackgroundBrush}"
        WindowStartupLocation="CenterScreen">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Logo and Title -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="ðŸŒ¸" FontSize="28" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <StackPanel>
                        <TextBlock Text="IrisSort" FontSize="22" FontWeight="SemiBold" 
                                   Foreground="{StaticResource TextBrush}"/>
                        <TextBlock Text="AI-powered image renaming" FontSize="12" 
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                    </StackPanel>
                </StackPanel>
                
                <!-- Connection Status -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Ellipse x:Name="ConnectionIndicator" Width="10" Height="10" 
                             Fill="{StaticResource ErrorBrush}" Margin="0,0,8,0"/>
                    <TextBlock x:Name="ConnectionStatus" Text="LM Studio: Checking..." 
                               FontSize="13" Foreground="{StaticResource TextSecondaryBrush}"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main Content -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- Action Bar -->
            <Border Grid.Row="0" Background="{StaticResource SurfaceBrush}" CornerRadius="8" 
                    Padding="16" Margin="0,0,0,16">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Path Display -->
                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                        <TextBlock Text="Selected Path:" FontSize="12" 
                                   Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4"/>
                        <TextBlock x:Name="SelectedPathText" Text="No folder selected" 
                                   FontSize="14" Foreground="{StaticResource TextBrush}"
                                   TextTrimming="CharacterEllipsis"/>
                    </StackPanel>
                    
                    <!-- Action Buttons -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Button x:Name="SelectFolderButton" Content="ðŸ“ Select Folder" 
                                Style="{StaticResource SecondaryButton}" Margin="0,0,8,0"
                                Click="SelectFolderButton_Click"/>
                        <Button x:Name="SelectFileButton" Content="ðŸ–¼ï¸ Select Image" 
                                Style="{StaticResource SecondaryButton}" Margin="0,0,8,0"
                                Click="SelectFileButton_Click"/>
                        <Button x:Name="AnalyzeButton" Content="âœ¨ Analyze" 
                                Style="{StaticResource PrimaryButton}" IsEnabled="False"
                                Click="AnalyzeButton_Click"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Results Area -->
            <Border Grid.Row="1" Background="{StaticResource SurfaceBrush}" CornerRadius="8">
                <Grid>
                    <!-- Empty State -->
                    <StackPanel x:Name="EmptyState" VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="ðŸ”" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                        <TextBlock Text="Select a folder or image to get started" 
                                   FontSize="16" Foreground="{StaticResource TextSecondaryBrush}"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="IrisSort will analyze your images and suggest filenames and tags" 
                                   FontSize="13" Foreground="{StaticResource TextSecondaryBrush}"
                                   HorizontalAlignment="Center" Margin="0,8,0,0"/>
                    </StackPanel>
                    
                    <!-- Progress State -->
                    <StackPanel x:Name="ProgressState" Visibility="Collapsed" 
                                VerticalAlignment="Center" HorizontalAlignment="Center">
                        <ProgressBar x:Name="AnalysisProgress" Width="300" Height="8" 
                                     IsIndeterminate="False" Maximum="100"/>
                        <TextBlock x:Name="ProgressText" Text="Analyzing..." 
                                   FontSize="14" Foreground="{StaticResource TextBrush}"
                                   HorizontalAlignment="Center" Margin="0,12,0,0"/>
                        <TextBlock x:Name="ProgressDetail" Text="" 
                                   FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"
                                   HorizontalAlignment="Center" Margin="0,4,0,0"/>
                        <Button x:Name="CancelButton" Content="Cancel" 
                                Style="{StaticResource SecondaryButton}" Margin="0,16,0,0"
                                Click="CancelButton_Click"/>
                    </StackPanel>
                    
                    <!-- Results Table -->
                    <Grid x:Name="ResultsState" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <!-- Results Header -->
                        <Border Grid.Row="0" Background="#252535" Padding="16">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock x:Name="ResultsSummary" Text="0 images analyzed" 
                                           FontSize="14" Foreground="{StaticResource TextBrush}"/>
                                <StackPanel Grid.Column="1" Orientation="Horizontal">
                                    <Button x:Name="AcceptAllButton" Content="âœ“ Accept All" 
                                            Style="{StaticResource SecondaryButton}" Margin="0,0,8,0"
                                            Click="AcceptAllButton_Click"/>
                                    <Button x:Name="RejectAllButton" Content="âœ— Reject All" 
                                            Style="{StaticResource SecondaryButton}"
                                            Click="RejectAllButton_Click"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Results List -->
                        <ListView x:Name="ResultsListView" Grid.Row="1" 
                                  Background="Transparent" BorderThickness="0"
                                  Foreground="{StaticResource TextBrush}"
                                  MouseDoubleClick="ResultsListView_MouseDoubleClick">
                            <ListView.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Copy Error Details" Click="CopyErrorMenuItem_Click"/>
                                    <MenuItem Header="Copy All Details" Click="CopyAllMenuItem_Click"/>
                                </ContextMenu>
                            </ListView.ContextMenu>
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="âœ“" Width="35">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsChecked="{Binding IsApproved}" 
                                                          VerticalAlignment="Center"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Original" Width="140" 
                                                    DisplayMemberBinding="{Binding OriginalFilename}"/>
                                    <GridViewColumn Header="New Name" Width="160" 
                                                    DisplayMemberBinding="{Binding SuggestedFilename}"/>
                                    <GridViewColumn Header="Title" Width="150" 
                                                    DisplayMemberBinding="{Binding Title}"/>
                                    <GridViewColumn Header="Subject" Width="140" 
                                                    DisplayMemberBinding="{Binding Subject}"/>
                                    <GridViewColumn Header="Tags" Width="220" 
                                                    DisplayMemberBinding="{Binding TagsDisplay}"/>
                                    <GridViewColumn Header="Status" Width="70" 
                                                    DisplayMemberBinding="{Binding StatusDisplay}"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                        
                        <!-- Apply Actions -->
                        <Border Grid.Row="2" Background="#252535" Padding="16">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="UndoButton" Content="â†© Undo Last" 
                                        Style="{StaticResource SecondaryButton}" Margin="0,0,8,0"
                                        IsEnabled="False" Click="UndoButton_Click"/>
                                <Button x:Name="ApplyButton" Content="ðŸš€ Apply Changes" 
                                        Style="{StaticResource PrimaryButton}"
                                        Click="ApplyButton_Click"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Grid>
            </Border>
        </Grid>
        
        <!-- Status Bar -->
        <Border Grid.Row="2" Background="{StaticResource SurfaceBrush}" Padding="16,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="StatusText" Text="Ready" FontSize="12" 
                           Foreground="{StaticResource TextSecondaryBrush}"/>
                <TextBlock Grid.Column="1" Text="Model: glm-4.6v-flash" FontSize="12" 
                           Foreground="{StaticResource TextSecondaryBrush}"/>
            </Grid>
        </Border>
    </Grid>
</Window>
